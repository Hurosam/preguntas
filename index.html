<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generador de Preguntas Aleatorias</title>
    <!-- LibrerÃ­as Externas (se cargan primero) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://unpkg.com/docx/dist/docx.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <!-- Estilos locales -->
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Todo el contenido del body es el mismo que antes -->
    <div class="container">
        <h1>ğŸ¯ Generador de Preguntas</h1>
        <div class="stats"><strong>ğŸ“Š Total de preguntas en la base de datos: <span id="totalQuestions">0</span></strong></div>
        <div class="section">
            <h2>ğŸ“ Cargar Preguntas desde Archivo</h2>
            <p class="upload-instructions"><strong>Nota:</strong> El archivo debe tener una sola columna. La primera fila debe ser el encabezado (ej. "pregunta") y las siguientes filas deben contener una pregunta cada una.</p>
            <img src="nota.jpg" alt="Ejemplo de formato de archivo" class="guide-image">
            <div class="file-upload-area" id="uploadArea">
                <input type="file" id="fileInput" accept=".xlsx,.xls,.csv" style="display: none;">
                <div id="uploadPrompt">
                    <div style="font-size: 48px; margin-bottom: 10px;">ğŸ“„</div>
                    <div style="font-size: 16px; color: #667eea; font-weight: 600;">Arrastra un archivo aquÃ­ o haz clic para seleccionar</div>
                    <div style="font-size: 14px; color: #888; margin-top: 5px;">Formatos soportados: .xlsx, .xls, .csv</div>
                </div>
            </div>
            <div class="loading" id="loadingFile"><div class="spinner"></div><div id="loadingFileName">Procesando archivo...</div></div>
            <div id="uploadAlertPlaceholder" style="margin-top: 15px;"></div>
        </div>
        <div class="section">
            <h2>âœï¸ Gestionar Preguntas</h2>
            <div class="form-group">
                <label for="newQuestion">Nueva pregunta:</label>
                <textarea id="newQuestion" placeholder="Escribe tu pregunta aquÃ­..."></textarea>
            </div>
            <button id="addQuestionBtn" class="btn-secondary">â• Agregar Pregunta</button>
            <button id="clearAllBtn" class="btn-danger">ğŸ—‘ï¸ Limpiar Todas</button>
            <a href="editar.html" class="button-style btn-edit">âœï¸ Editar Preguntas</a>
            <button id="exportAllCsvBtn" class="btn-export">ğŸ“¥ Descargar como CSV</button>
            <button id="exportAllExcelBtn" class="btn-export-excel">ğŸ“¥ Descargar como Excel</button>
            <button id="exportAllWordBtn" class="button-style" style="background: linear-gradient(45deg, #2980b9, #3498db);">ğŸ“¥ Descargar como Word</button>
        </div>
        <div class="section">
            <h2>ğŸ² Generar Preguntas Aleatorias</h2>
            <div class="form-group">
                <label for="questionCount">NÃºmero de preguntas a generar:</label>
                <input type="number" id="questionCount" min="1" value="5">
            </div>
            <button id="generateBtn">ğŸš€ Generar Preguntas</button>
        </div>
        <div class="section">
            <h2>ğŸ“ Preguntas Generadas</h2>
            <div id="generatedQuestions" class="questions-container"><div style="text-align: center; color: #888; padding: 40px;">No hay preguntas generadas aÃºn.</div></div>
            <div id="generatedActions" class="generated-actions" style="display: none;">
                <button id="exportGenCsvBtn" class="btn-export">Descargar Lista (CSV)</button>
                <button id="exportGenExcelBtn" class="btn-export-excel">Descargar Lista (Excel)</button>
                <button id="exportGenWordBtn" class="button-style" style="background: linear-gradient(45deg, #2980b9, #3498db);">Descargar Lista (Word)</button>
            </div>
        </div>
    </div>
    <div class="modal-overlay" id="customConfirm">
        <div class="modal-content">
            <p id="confirmMessage"></p>
            <div class="modal-buttons">
                <button id="confirmYes" class="btn-danger">SÃ­, eliminar</button>
                <button id="confirmNo" class="btn-secondary">Cancelar</button>
            </div>
        </div>
    </div>
    
    <!-- CAMBIO: Nuestro script local se carga al final, despuÃ©s de todo lo demÃ¡s -->
    <script src="index-script.js"></script>
</body>
</html>